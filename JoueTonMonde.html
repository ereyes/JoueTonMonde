<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta charset="utf-8" />
<title>Joue ton Monde</title>
<link type="text/css" rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.1/css/bootstrap.min.css" />
	<style>
	audio{display:none}
	.container {width:500px;}
	.unPlayer {border: 1px solid #428bca; padding: 20px;margin: 20px;}
	.audiocontrols > .volume {width:140px; position:relative; height:14px}
	.audiocontrols > .volume > .slider{position:relative;border-radius:5px;background:#dedede; width:100px;height:10px;display:inline-block}
	.audiocontrols > .volume > .slider > .knob{position:absolute;top:0;left:0;background:#999;border-radius:10px; width:10px; height:10px;cursor:pointer}
	</style>
</head>

<body>
	<div class="container">
    <audio preload="auto" autobuffer controls id="audio">
        <source src="04_1904.ogg" type="audio/ogg"  />
        <source src="test.mp3" type="audio/mpeg" />
        <source src="test.wav" type="audio/wav" />
    </audio>
    <div class="audiocontrols">
        <a href="#" class="play"><i class="icon-play"></i></a>
        <a href="#" class="pause"><i class="icon-pause"></i></a>
        
        <div class="volume">
            <a href="#" class="down"><i class="icon-volume-down"></i></a>
            <div class="slider"><span class="knob"></span></div>
            <a href="#" class="up"><i class="icon-volume-up"></i></a>
        </div>
    </div>
</div>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/jquery-ui.min.js"></script>

<script type="text/javascript">
(function($){
	var audio = document.getElementById('audio');
	$('.audiocontrols a.play').on('click',function(e){
		e.preventDefault();
		audio.play();
	});
	$('.audiocontrols a.pause').on('click',function(e){
		e.preventDefault();
		audio.pause();
	});
		$('.down').on('click',function(e){
		e.preventDefault();	
		audio.volume=Math.max(audio.volume-0.1,0);
	});
	$('.up').on('click',function(e){
		e.preventDefault();	
		audio.volume=Math.min(audio.volume+0.1,1);
	});
	
	// create a draggable knob within its parent with JqueryUI Draggable.
	$(".knob").draggable({
		containment:"parent",
		drag:function(evt,ui){
			var newVol = Math.round(ui.position.left / $(this).parent().width()*10) / 10;
			audio.volume=newVol;
		}
		});
		
	//Clique sur la barre de dÃ©filement pour bouger rapidement sans dragger.
	$('.slider').on('click',function(e){
		if(!$(e.target).hasClass('slider'))return;
		var newVol = Math.round(e.offsetX/ $(this).width()*10) / 10;
		audio.volume=newVol;	
	});
	
	//Function that places the knob according to current volume.
	$(audio).on('volumechange',function(){
		$('.knob').css('left',Math.min(audio.volume*$('.knob').parent().width(),$('.knob').parent().width()-$('.knob').width())+'px');
		localStorage.setItem('volume',audio.volume);
	});
	//Lecteur des prÃ©fÃ©rences de l'utilisateur.
	audio.volume=(localStorage.getItem('volume')||1);
	//Forcing an audiochange event.
	$(audio).trigger('volumechange');
	//Audio controls, play, pause and stop
	
})(jQuery);

</script>
</body>
</html>