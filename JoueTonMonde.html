<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset="utf-8" />
<title>Joue ton Monde !</title>

	<style>
	audio{display:none}
	.container {width:500px;}
	.unPlayer {border: 1px solid #428bca; padding: 20px;margin: 20px;}
	.audiocontrols > .volume {width:140px; position:relative; height:14px}
	.audiocontrols > .volume > .slider{position:relative;border-radius:5px;background:#dedede; width:100px;height:10px;display:inline-block}
	.audiocontrols > .volume > .slider > .knob{position:absolute;top:0;left:0;background:#999;border-radius:10px; width:10px; height:10px;cursor:pointer}
	</style>
</head>

<body>
<div class="container">
	<div class="unPlayer">
	    <audio preload="auto" autobuffer controls id="audio1">
	        <source src="204535_2244250-lq.ogg" type="audio/ogg"  />
	        <source src="test.mp3" type="audio/mpeg" />
	        <source src="test.wav" type="audio/wav" />
	    </audio>
	    <div class="audiocontrols">
	        <a href="#" class="play" data-audio="audio1"><img width="10" height="10"src="playicon.png"></a>
	        <a href="#" class="pause" data-audio="audio1"><img width="10" height="10"src="pauseicon.png"></a>
	        <div class="volume">
	            <a href="#" class="down" data-audio="audio1"><i class="glyphicon glyphicon-volume-down"></i></a>
	            <div class="slider" data-audio="audio1"><span class="knob"></span></div>
	            <a href="#" class="up" data-audio="audio1"><i class="glyphicon glyphicon-volume-up"></i></a>
	        </div>
	    </div>
</div>
	
</div>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/jquery-ui.min.js"></script>

<script type="text/javascript">
(function($){

	$('.audiocontrols a.play').on('click',function(e){
		e.preventDefault();
		$('#'+$(this).attr('data-audio'))[0].play();
	});
	$('.audiocontrols a.pause').on('click',function(e){
		e.preventDefault();
		$('#'+$(this).attr('data-audio'))[0].pause();
	});
	$('.audiocontrols a.stop').on('click',function(e){
		e.preventDefault();
		$('#'+$(this).attr('data-audio'))[0].pause();
		$('#'+$(this).attr('data-audio'))[0].currentTime=0;
	});

	$('.down').on('click',function(e){
		e.preventDefault();
		$('#'+$(this).attr('data-audio'))[0].volume=Math.max($('#'+$(this).attr('data-audio'))[0].volume-0.1,0);
	});
	$('.up').on('click',function(e){
		e.preventDefault();
		$('#'+$(this).attr('data-audio'))[0].volume=Math.min($('#'+$(this).attr('data-audio'))[0].volume+0.1,1);
	});

	// create a draggable knob within its parent with JqueryUI Draggable.
	$('.knob').draggable({
		containment:"parent",
		drag:function(evt,ui){
			var newVol = Math.round(ui.position.left / $(this).parent().width()*10) / 10;
			$('audio').each(function(index,element){
				element.volume=newVol;
			});
		}
	});

	//Clique sur la barre de dÃ©filement pour bouger rapidement sans dragger.
	$('.slider').on('click',function(e){
		console.log('clicking...')
		if(!$(e.target).hasClass('slider'))return;
		var newVol = Math.round(e.offsetX/ $(this).width()*10) / 10;
		$('audio').each(function(index,element){
			element.volume=newVol;
		});
	});

	//Function that places the knob according to current volume.
	$('audio').on('volumechange',function(){
		//console.log($(this)[0].volume);
		$('.knob').css('left',Math.min($(this)[0].volume*$('.knob').parent().width(),$('.knob').parent().width()-$('.knob').width())+'px');
		//console.log($(this).volume);
		localStorage.setItem('volume',$(this)[0].volume);
	});
	//Lecteur des prÃ©fÃ©rences de l'utilisateur.
	$('#'+$(this).attr('data-audio')).each(function(index,element){
		element.volume=(localStorage.getItem('volume')||1);
	});
	//Forcing an audiochange event.
	$('audio').trigger('volumechange');


})(jQuery);

</script>

</script>
</body>
</html>